<?php

$helpurl = Config::get('help_url') ?: '#';
$abouturl = Config::get('about_url') ?: '#';

?>

<nav class="top-bar <?php echo Auth::isAuthenticated() ? '' : 'disconnected' ?>" data-options="back_text:Retour au menu" data-topbar="" role="navigation">
    <ul class="title-area">
        <li class="name">
            <a href="{path:?s=home}" title="{cfg:site_name} : {tr:home}">
                <img src="{path:skin/images/logo_filesender.svg}" alt="Logo Filesender" data-options="disable_for_touch:true" class="radius" alt="FileSender logo" />
            </a>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#"><span title="Menu dÃ©roulant">menu</span></a></li>
    </ul>
    <menu class="top-bar-section">
        <ul class="right ">
            <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-home" aria-haspopup="true" class="radius" title="{tr:home}">
                <a href="?s=home">
                    <i class="fi-home"></i><label>{tr:home}</label>
                </a>
            </li>
            
            <?php if(GUI::isUserAllowedToAccessPage('admin')) { ?>
                <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-admin" aria-haspopup="true" class="radius" title="{tr:admin_page}">
                    <a id="topmenu_admin" href="?s=admin">
                        <i class="fa fa-cogs"></i> <label>{tr:admin_page}</label>
                    </a>
                </li>
            <?php } ?>

            <?php if(Config::get('lang_selector_enabled')) { ?>
                <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-lang" aria-haspopup="true" class="radius" title="{tr:change_language}">
                    <i class="fa fa-language"></i>
                    <select id="language_selector">
                    <?php foreach (Lang::getAvailableLanguages() as $id => $dfn) { ?>
                        <option value="<?php echo $id ?>" <?php echo ($id == Lang::getCode()) ? 'selected="selected"' : '' ?>><?php echo Utilities::sanitizeOutput($dfn['name']) ?></option>
                    <?php } ?>
                    </select>
                </li>
            <?php } ?>
            
            <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-help" aria-haspopup="true" class="radius" title="{tr:help}">
                <a href="<?php echo $helpurl ?>" target="_blank" id="topmenu_help">
                    <i class="fa fa-question-circle"></i><label>{tr:help}</label>
                </a>
            </li>
            
            <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-about" aria-haspopup="true" class="radius" title="{tr:about}">
                <a href="<?php echo $abouturl ?>" target="_blank" id="topmenu_about">
                    <i class="fa fa-info-circle"></i><label>{tr:about}</label>
                </a>
            </li>
            
            <?php if(Auth::isAuthenticated() && Auth::isSP()) { ?>
            <li class="has-dropdown show-for-medium-up">
                <a href="#">
                    <i class="fa fa-user"></i><label><?php echo Auth::user()->email ?></label>
                </a>
                
                <ul class="dropdown">
                    <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-user" aria-haspopup="true" class="radius" title="{tr:user_page}">
                        <a href="?s=user">
                            <i class="fa fa-cogs"></i> <label>{tr:user_page}</label>
                        </a>
                    </li>
                    
                    <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-logout" aria-haspopup="true" class="radius" title="{tr:logoff}">
                        <a href="<?php echo AuthSP::logoffURL() ?>" id="topmenu_logoff">
                            <i class="fi-power"></i> <label>{tr:logoff}</label>
                        </a>
                    </li>
                </ul>
            </li>
            
            <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-user" aria-haspopup="true" class="radius show-for-small" title="{tr:user_page}">
                <a href="?s=user">
                    <i class="fa fa-cogs"></i> <label>{tr:user_page}</label>
                </a>
            </li>
            
            <li data-tooltip data-options="disable_for_touch:true" data-selector="tooltip-menu-logout" aria-haspopup="true" class="radius show-for-small" title="{tr:logoff}">
                <a href="<?php echo AuthSP::logoffURL() ?>" id="topmenu_logoff">
                    <i class="fi-power"></i> <label>{tr:logoff}</label>
                </a>
            </li>
            <?php } ?>
        </ul>
    </menu>
</nav>

<?php if(!Auth::isAuthenticated() && !Auth::isGuest()) Template::display('wayf') ?>

