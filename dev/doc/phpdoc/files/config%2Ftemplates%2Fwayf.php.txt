<?php
$wayfInstance = (strrpos($_SERVER['SERVER_NAME'], "dev-") === false) ? 'https://discovery.renater.fr/renater/WAYF' : 'https://discovery.renater.fr/test/WAYF';
$host = Config::get('site_url');

?>

<div id="embeddedWAYF">
    <h1 ><?php echo Lang::tr('logon'); ?></h1>
    <!-- EMBEDDED-WAYF-START -->
    <script type="text/javascript">
        var target = 
        <?php
            if (isset($_GET['uuid']))
                echo "'target=' + encodeURIComponent('/?uuid=" . $_GET['uuid'] . "');";
            else
                echo "'';";
        ?>

        var wayf_URL = "<?php echo $wayfInstance ?>";
        var wayf_sp_entityID = "<?php echo $host; ?>";
        var wayf_sp_handlerURL = "<?php echo $host . "/Shibboleth.sso"; ?>";
        var wayf_return_url = "<?php echo $host; ?>";
        var wayf_show_remember_checkbox = false;
        var wayf_force_remember_for_session = false;
        var wayf_use_small_logo = true;
        var wayf_font_size = 12;
        var wayf_font_color = '#000000';
        var wayf_border_color = 'transparent';
        var wayf_background_color = 'transparent';
        var wayf_hide_logo = true;
        var wayf_auto_login = true;
        var wayf_hide_after_login = true;
        var wayf_show_categories = true;
        var wayf_use_discovery_service = true;
        var wayf_sp_samlDSURL = wayf_sp_handlerURL + "/Login?" + target;
        var wayf_overwrite_intro_text = '';
        var wayf_use_improved_drop_down_list = true;
    </script>

    <script type="text/javascript" src="<?php echo $wayfInstance ?>/embedded-wayf.js"></script>

    <noscript>
    <p>
        <strong>Login:</strong> Javascript is not available for your web browser. Therefore, please <a href="<?php echo $wayfInstance ?>?entityID=https%3A%2F%2F<?php echo $host; ?>%2F&return=https%3A%2F%2F<?php echo $host; ?>%2FShibboleth.sso%2FLogin%3FSAMLDS%3D1">proceed manually</a>.
    </p>
    </noscript>

    <?php
    if (Config::get('show_btn_connection_cru') === true) {
        echo Lang::tr('If your home organization is not listed in the above menu:') . "<hr />";
        echo "<button id='wayfHomelessButton'>" . Lang::tr('Login using CRU account') . "</button>";
    }
    ?>

    <!-- EMBEDDED-WAYF-END -->
</div>

<?php ?>

